{
  "version": "1.0",
  "proposal": {
    "proposed_policy": {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Effect": "Allow",
          "Action": [
            "s3:GetObject",
            "s3:ListBucket",
            "s3:PutObject"
          ],
          "Resource": [
            "arn:aws:s3:::app-data-bucket",
            "arn:aws:s3:::app-data-bucket/*"
          ],
          "Condition": {
            "StringEquals": {
              "aws:PrincipalOrgID": "o-abc123xyz"
            }
          }
        },
        {
          "Effect": "Allow",
          "Action": [
            "dynamodb:Query",
            "dynamodb:GetItem",
            "dynamodb:PutItem"
          ],
          "Resource": "arn:aws:dynamodb:us-east-1:123456789012:table/user-sessions",
          "Condition": {
            "StringEquals": {
              "aws:RequestedRegion": "us-east-1"
            }
          }
        },
        {
          "Effect": "Allow",
          "Action": [
            "logs:PutLogEvents",
            "logs:CreateLogStream"
          ],
          "Resource": "arn:aws:logs:us-east-1:123456789012:log-group:/aws/lambda/app:*",
          "Condition": {
            "StringEquals": {
              "aws:RequestedRegion": "us-east-1"
            }
          }
        }
      ]
    },
    "rationale": "Based on 30 days of CloudTrail analysis (1,245 datapoints), this role exhibits access patterns for S3 (read/write to app-data-bucket), DynamoDB (CRUD on user-sessions table), and CloudWatch Logs (application logging). The proposed policy scopes permissions to specific ARNs and adds organizational boundary conditions to prevent cross-org access.",
    "guardrail_violations": [
      {
        "code": "MISSING_CONDITION",
        "message": "Condition StringEquals must be present.",
        "path": "statement[1].Condition"
      },
      {
        "code": "MISSING_CONDITION",
        "message": "Condition StringEquals must be present.",
        "path": "statement[2].Condition"
      }
    ],
    "risk_signal": {
      "probability_of_break": 0.05,
      "rationale": "High confidence assessment based on comprehensive telemetry. Added s3:ListBucket for pagination support despite no direct observations. All observed actions mapped to specific resources. No missing dependencies detected."
    },
    "remediation_notes": [
      "Ensure S3 bucket policy allows cross-account access if needed",
      "Monitor DynamoDB throttling after deployment",
      "Validate log group permissions during canary phase"
    ]
  },
  "diff": {
    "existing_policy": {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Effect": "Allow",
          "Action": "*",
          "Resource": "*"
        }
      ]
    },
    "proposed_policy": {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Effect": "Allow",
          "Action": [
            "s3:GetObject",
            "s3:ListBucket",
            "s3:PutObject"
          ],
          "Resource": [
            "arn:aws:s3:::app-data-bucket",
            "arn:aws:s3:::app-data-bucket/*"
          ],
          "Condition": {
            "StringEquals": {
              "aws:PrincipalOrgID": "o-abc123xyz"
            }
          }
        },
        {
          "Effect": "Allow",
          "Action": [
            "dynamodb:Query",
            "dynamodb:GetItem",
            "dynamodb:PutItem"
          ],
          "Resource": "arn:aws:dynamodb:us-east-1:123456789012:table/user-sessions",
          "Condition": {
            "StringEquals": {
              "aws:RequestedRegion": "us-east-1"
            }
          }
        },
        {
          "Effect": "Allow",
          "Action": [
            "logs:PutLogEvents",
            "logs:CreateLogStream"
          ],
          "Resource": "arn:aws:logs:us-east-1:123456789012:log-group:/aws/lambda/app:*",
          "Condition": {
            "StringEquals": {
              "aws:RequestedRegion": "us-east-1"
            }
          }
        }
      ]
    },
    "added_actions": [
      "dynamodb:GetItem",
      "dynamodb:PutItem",
      "dynamodb:Query",
      "logs:CreateLogStream",
      "logs:PutLogEvents",
      "s3:GetObject",
      "s3:ListBucket",
      "s3:PutObject"
    ],
    "removed_actions": [
      "*"
    ],
    "change_summary": "+8 actions, -1 actions"
  },
  "metadata": {
    "role_arn": "arn:aws:iam::123456789012:role/OverprivilegedAdminRole",
    "usage_days": 30,
    "guardrails": "prod",
    "mode": "judge",
    "exit_code": 3
  }
}